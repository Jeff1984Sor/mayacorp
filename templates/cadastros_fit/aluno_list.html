{% extends 'base.html' %}
{% load static %}

{% block title %}Gestão de Alunos | MayaCorp Fit{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto pb-20 px-4">
    
    <!-- HEADER: Imponente e Vibrante -->
    <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-12 gap-6">
        <div class="flex items-center gap-5">
            <!-- Ícone em MARSALA -->
            <div class="w-16 h-16 bg-primary rounded-[22px] flex items-center justify-center text-white shadow-xl shadow-primary/30 border-2 border-white transition-transform hover:scale-110">
                <i class="fas fa-users text-2xl"></i>
            </div>
            <div>
                <h1 class="text-4xl font-black text-slate-900 tracking-tighter">Gestão de Alunos</h1>
                <p class="text-[11px] text-primary font-black uppercase tracking-[3px] mt-1">
                    Total de <span class="text-slate-900">{{ alunos|length }}</span> membros ativos no studio
                </p>
            </div>
        </div>
        
        <!-- Botão Novo Aluno em AZUL VIBRANTE -->
        <a href="{% url 'aluno_create' %}" 
           class="btn bg-secondary border-none text-white rounded-2xl px-10 h-16 shadow-2xl shadow-secondary/30 hover:bg-blue-800 hover:scale-105 transition-all normal-case font-black uppercase tracking-widest text-xs">
            <i class="fas fa-user-plus mr-2 text-lg"></i> NOVO ALUNO
        </a>
    </header>

    <!-- LISTA DE ALUNOS (Card Premium Studio) -->
    <div class="bg-white rounded-[3rem] shadow-2xl shadow-slate-200/60 overflow-hidden border border-slate-100">
        <div class="overflow-x-auto">
            <table class="table w-full border-collapse">
                <!-- CABEÇALHO COM CONTRASTE MÁXIMO -->
                <thead>
                    <tr class="bg-slate-900 border-none">
                        <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 pl-12">Perfil do Aluno</th>
                        <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8">Identificação</th>
                        <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8">Contato Direto</th>
                        <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 text-center">Status</th>
                        <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 pr-12 text-right">Ações</th>
                    </tr>
                </thead>
                
                <tbody class="divide-y divide-slate-100">
                    {% for aluno in alunos %}
                    <tr class="hover:bg-primary/5 transition-colors group cursor-pointer" 
                        onclick="window.location='{% url 'cadastros:aluno_detail' aluno.pk %}'">
                        
                        <!-- ALUNO (Avatar + Nome) -->
                        <td class="py-7 pl-12">
                            <div class="flex items-center gap-5">
                                <div class="avatar">
                                    <div class="w-16 h-16 rounded-3xl shadow-xl shadow-primary/10 border-4 border-white group-hover:scale-110 transition-transform ring-1 ring-slate-100">
                                        {% if aluno.foto_rosto %}
                                            <img src="{{ aluno.foto_rosto.url }}" class="object-cover" />
                                        {% else %}
                                            <div class="bg-slate-100 flex items-center justify-center text-primary font-black text-2xl uppercase">
                                                {{ aluno.nome|first }}
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="flex flex-col">
                                    <span class="text-slate-900 font-black text-lg group-hover:text-primary transition-colors tracking-tighter">{{ aluno.nome|upper }}</span>
                                    <span class="text-xs text-slate-400 font-bold lowercase italic tracking-wide">{{ aluno.email|default:"sem e-mail cadastrado" }}</span>
                                </div>
                            </div>
                        </td>

                        <!-- CPF / ID -->
                        <td class="py-7">
                            <span class="text-xs font-black text-slate-700 bg-slate-100 px-4 py-2 rounded-xl border border-slate-200 uppercase tracking-widest">
                                {{ aluno.cpf|default:"Não informado" }}
                            </span>
                        </td>

                        <!-- TELEFONE (AZUL) -->
                        <td class="py-7">
                            <div class="flex items-center gap-3 text-slate-700 text-sm font-black uppercase tracking-tighter">
                                <div class="w-8 h-8 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600">
                                    <i class="fab fa-whatsapp"></i>
                                </div>
                                {{ aluno.telefone }}
                            </div>
                        </td>

                        <!-- STATUS (VIBRANTE) -->
                        <td class="py-7 text-center">
                            {% if aluno.bloqueado_catraca %}
                                <div class="badge bg-primary border-none text-white text-[10px] font-black py-4 px-6 rounded-xl shadow-lg shadow-primary/20">BLOQUEADO</div>
                            {% elif aluno.ativo %}
                                <div class="badge bg-emerald-500 border-none text-white text-[10px] font-black py-4 px-6 rounded-xl shadow-lg shadow-emerald-200">ATIVO</div>
                            {% else %}
                                <div class="badge bg-slate-400 border-none text-white text-[10px] font-black py-4 px-6 rounded-xl">INATIVO</div>
                            {% endif %}
                        </td>

                        <!-- AÇÕES (AZUL E MARSALA) -->
                        <td class="py-7 pr-12 text-right">
                            <div class="flex justify-end gap-3" onclick="event.stopPropagation();">
                                <a href="{% url 'cadastros:aluno_update' aluno.pk %}" 
                                   class="btn btn-square btn-sm rounded-xl bg-slate-100 border-none text-slate-400 hover:bg-secondary hover:text-white transition-all shadow-sm" 
                                   title="Editar Dados">
                                    <i class="fas fa-edit text-base"></i>
                                </a>
                                <a href="{% url 'aluno_delete' aluno.pk %}" 
                                   class="btn btn-square btn-sm rounded-xl bg-slate-100 border-none text-slate-400 hover:bg-primary hover:text-white transition-all shadow-sm" 
                                   title="Excluir Aluno">
                                    <i class="fas fa-trash-alt text-base"></i>
                                </a>
                            </div>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="5" class="py-32 text-center">
                            <div class="flex flex-col items-center">
                                <div class="w-28 h-28 bg-slate-50 rounded-[3rem] flex items-center justify-center text-slate-200 mb-8 border-2 border-dashed border-slate-200">
                                    <i class="fas fa-user-slash text-4xl"></i>
                                </div>
                                <h3 class="text-slate-900 text-2xl font-black tracking-tight">O studio está vazio?</h3>
                                <p class="text-slate-400 mt-2 font-bold uppercase tracking-[2px] text-xs">Comece cadastrando o primeiro aluno acima.</p>
                                <a href="{% url 'aluno_create' %}" class="btn btn-primary mt-8 rounded-2xl">CADASTRAR AGORA</a>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}