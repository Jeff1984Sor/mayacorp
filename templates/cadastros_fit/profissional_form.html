{% extends "base.html" %}
{% load static %}

{% block title %}
{% if object %}Editar Profissional{% else %}Novo Profissional{% endif %} | MayaCorp Fit
{% endblock %}

{% block content %}

<form method="post" class="max-w-4xl mx-auto space-y-16 fade-in">
{% csrf_token %}

<!-- ================= HEADER ================= -->
<section class="flex items-center justify-between">
    <div>
        <h1 class="text-3xl font-black tracking-tight text-white">
            {% if object %}Editar Profissional{% else %}Novo Profissional{% endif %}
        </h1>
        <p class="text-xs uppercase tracking-[0.3em] text-white/60 mt-2">
            Controle de acesso e agenda
        </p>
    </div>

    <!-- ATIVO -->
    <label class="flex items-center gap-4 bg-white/5 px-6 py-4 rounded-2xl">
        <span class="text-xs uppercase tracking-widest text-white/60">
            Ativo
        </span>

        <!-- garante envio mesmo desmarcado -->
        <input type="hidden" name="ativo" value="off">
        <input
            type="checkbox"
            name="ativo"
            value="on"
            class="toggle toggle-primary"
            {% if object and object.ativo or not object %}checked{% endif %}
        >
    </label>
</section>

<!-- ================= ACESSO ================= -->
<section class="card surface-hover">
    <h2 class="card-title">Acesso ao Sistema</h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- USUÁRIO -->
        <div class="field">
            <label class="label">Usuário</label>

            {% if object %}
                <input class="input opacity-60 cursor-not-allowed" value="{{ object.user.username }}" disabled>
                <input type="hidden" name="username" value="{{ object.user.username }}">
            {% else %}
                <input name="username" class="input" required>
            {% endif %}
        </div>

        <!-- SENHA -->
        <div class="field">
            <label class="label">
                {% if object %}Nova Senha (opcional){% else %}Senha Inicial{% endif %}
            </label>
            <input
                type="password"
                name="password"
                class="input"
                {% if not object %}required{% endif %}
                autocomplete="new-password"
            >
            {% if object %}
            <p class="text-[10px] text-white/40 mt-2 uppercase tracking-widest">
                Preencha apenas se desejar alterar
            </p>
            {% endif %}
        </div>

        <!-- PERFIL -->
        <div class="field">
            <label class="label">Perfil</label>
            <select name="perfil" class="select">
                <option value="INSTRUTOR" {% if object.perfil == "INSTRUTOR" %}selected{% endif %}>
                    Instrutor
                </option>
                <option value="ADMIN" {% if object.perfil == "ADMIN" %}selected{% endif %}>
                    Administrador
                </option>
            </select>
        </div>
    </div>
</section>

<!-- ================= DADOS ================= -->
<section class="card surface-hover">
    <h2 class="card-title">Dados Pessoais</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="field">
            <label class="label">Nome Completo</label>
            <input name="nome" class="input" value="{{ object.nome|default:'' }}" required>
        </div>

        <div class="field">
            <label class="label">CPF</label>
            <input name="cpf" class="input" value="{{ object.cpf|default:'' }}" required>
        </div>

        <div class="field">
            <label class="label">E-mail</label>
            <input type="email" name="email" class="input" value="{{ object.email|default:'' }}">
        </div>

        <div class="field">
            <label class="label">Telefone</label>
            <input name="telefone" class="input" value="{{ object.telefone|default:'' }}">
        </div>
    </div>
</section>

<!-- ================= AGENDA ================= -->
<section class="card surface-hover">
    <h2 class="card-title">Agenda & Financeiro</h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-end">
        <div class="field">
            <label class="label">Registro Profissional</label>
            <input name="crefito" class="input" value="{{ object.crefito|default:'' }}">
        </div>

        <div class="field">
            <label class="label">Valor por Aula</label>
            <input
                type="number"
                step="0.01"
                name="valor_hora_aula"
                class="input"
                value="{{ object.valor_hora_aula|default:'0.00' }}"
            >
        </div>

        <div class="field">
            <label class="label">Cor na Agenda</label>
            <input
                type="color"
                name="cor_agenda"
                value="{{ object.cor_agenda|default:'#802422' }}"
                class="h-14 w-full rounded-xl border border-white/20 bg-transparent"
            >
        </div>
    </div>
</section>

<!-- ================= ACTION ================= -->
<section class="flex justify-between pt-10">
    <a href="{% url 'profissional_list' %}"
       class="text-xs uppercase tracking-widest text-white/50 hover:text-white transition">
        Cancelar
    </a>

    <button class="btn btn-primary px-16 h-16 text-sm uppercase tracking-widest font-black">
        Salvar Profissional
    </button>
</section>

</form>

{% endblock %}
