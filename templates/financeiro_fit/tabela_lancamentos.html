<!-- TABELA DE LANÇAMENTOS (Visual Studio MayaCorp Fit) -->
<div class="bg-white rounded-[3.5rem] shadow-2xl shadow-slate-200/60 overflow-hidden border border-slate-100 animate-in fade-in duration-700 relative">
    
    <!-- Detalhe decorativo lateral em Marsala -->
    <div class="absolute left-0 top-0 w-1.5 h-full bg-primary opacity-30"></div>

    <div class="overflow-x-auto">
        <table class="table w-full border-collapse">
            <!-- CABEÇALHO MÁXIMO CONTRASTE -->
            <thead>
                <tr class="bg-slate-900 border-none">
                    <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 pl-12 text-left">Vencimento</th>
                    <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 text-left">Descrição Detalhada</th>
                    <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 text-left">Classificação / Origem</th>
                    <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 text-center">Valor Bruto</th>
                    <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 text-center">Situação</th>
                    <th class="text-white uppercase text-[11px] tracking-[2px] font-black py-8 pr-12 text-right">Gestão</th>
                </tr>
            </thead>
            
            <tbody class="divide-y divide-slate-100">
                {% for lanc in lancamentos %}
                <tr class="hover:bg-primary/5 transition-all group">
                    
                    <!-- VENCIMENTO (NITIDEZ TOTAL) -->
                    <td class="py-7 pl-12">
                        <div class="flex flex-col">
                            <span class="text-slate-900 font-black text-base">{{ lanc.data_vencimento|date:"d/m/Y" }}</span>
                            {% if lanc.status == 'PAGO' %}
                                <span class="text-[10px] text-emerald-600 font-black uppercase mt-1">
                                    <i class="fas fa-check-circle mr-1"></i> LIQUIDADO {{ lanc.data_pagamento|date:"d/m" }}
                                </span>
                            {% elif lanc.data_vencimento < hoje and lanc.status == 'PENDENTE' %}
                                <span class="text-[10px] text-primary font-black uppercase mt-1 animate-pulse">
                                    <i class="fas fa-triangle-exclamation mr-1"></i> EM ATRASO
                                </span>
                            {% else %}
                                <span class="text-[10px] text-slate-400 font-black uppercase mt-1">PROJETADO</span>
                            {% endif %}
                        </div>
                    </td>

                    <!-- DESCRIÇÃO (MARSALA FOCUS) -->
                    <td class="py-7">
                        <div class="flex flex-col">
                            <span class="text-sm font-black text-slate-800 uppercase tracking-tight group-hover:text-primary transition-colors leading-tight">{{ lanc.descricao }}</span>
                            <div class="flex items-center gap-2 mt-1">
                                <i class="fas fa-vault text-slate-300 text-[9px]"></i>
                                <span class="text-[10px] text-slate-400 font-black uppercase tracking-widest">{{ lanc.conta.nome }}</span>
                            </div>
                        </div>
                    </td>
                    
                    <!-- CATEGORIA / ALUNO (VIBRANTE) -->
                    <td class="py-7">
                        <div class="flex flex-col gap-2">
                            <span class="badge {% if lanc.categoria.tipo == 'RECEITA' %}bg-emerald-500 shadow-emerald-200{% else %}bg-primary shadow-primary/20{% endif %} border-none text-white text-[9px] font-black px-4 py-3 rounded-lg shadow-md uppercase tracking-widest">
                                {{ lanc.categoria.nome }}
                            </span>
                            {% if lanc.aluno %}
                                <a href="{% url 'aluno_detail' lanc.aluno.id %}" class="text-[10px] font-black text-secondary uppercase tracking-widest hover:underline flex items-center gap-2 mt-1">
                                    <i class="fas fa-user-circle text-xs"></i> {{ lanc.aluno.nome|upper }}
                                </a>
                            {% endif %}
                        </div>
                    </td>

                    <!-- VALOR (ALTO CONTRASTE) -->
                    <td class="py-7 text-center">
                        <div class="text-xl font-black tracking-tighter italic {% if lanc.categoria.tipo == 'RECEITA' %}text-emerald-600{% else %}text-primary{% endif %}">
                            <span class="text-xs opacity-40 mr-1 not-italic">R$</span> {{ lanc.valor }}
                        </div>
                    </td>
                    
                    <!-- SITUAÇÃO (BADGES SÓLIDOS VIBRANTES) -->
                    <td class="py-7 text-center">
                        {% if lanc.status == 'PAGO' %}
                            <div class="badge bg-emerald-500 border-none text-white text-[10px] font-black py-4 px-6 rounded-xl shadow-lg shadow-emerald-200 uppercase tracking-widest">PAGO</div>
                        {% elif lanc.status == 'PENDENTE' %}
                            {% if lanc.data_vencimento < hoje %}
                                <div class="badge bg-primary border-none text-white text-[10px] font-black py-4 px-6 rounded-xl shadow-lg shadow-primary/20 uppercase tracking-widest animate-bounce">ATRASO</div>
                            {% else %}
                                <div class="badge bg-accent border-none text-accent-content text-[10px] font-black py-4 px-6 rounded-xl shadow-lg shadow-accent/20 uppercase tracking-widest">ABERTO</div>
                            {% endif %}
                        {% else %}
                            <div class="badge bg-slate-400 border-none text-white text-[10px] font-black py-4 px-6 rounded-xl uppercase tracking-widest">CANCEL.</div>
                        {% endif %}
                    </td>

                    <!-- AÇÕES (VERDE VIBRANTE) -->
                    <td class="py-7 pr-12 text-right">
                        {% if lanc.status == 'PENDENTE' %}
                            <form action="{% url 'baixar_lancamento' lanc.id %}" method="post" class="inline">
                                {% csrf_token %}
                                <input type="hidden" name="forma_pagamento" value="PIX"> 
                                <button class="btn bg-emerald-500 border-none text-white hover:bg-emerald-600 transition-all rounded-xl px-6 h-12 min-h-0 text-[10px] font-black uppercase tracking-widest shadow-xl shadow-emerald-200 hover:scale-105 active:scale-95 group/btn" 
                                        onclick="return confirm('Confirmar liquidação deste lançamento no sistema?')">
                                    <i class="fas fa-check-double mr-2 group-btn/hover:animate-pulse"></i> BAIXAR
                                </button>
                            </form>
                        {% else %}
                            <div class="w-12 h-12 bg-emerald-50 rounded-full flex items-center justify-center text-emerald-500 mx-auto shadow-inner">
                                <i class="fas fa-check-circle text-xl"></i>
                            </div>
                        {% endif %}
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="py-32 text-center">
                        <div class="flex flex-col items-center">
                            <div class="w-28 h-28 bg-slate-50 rounded-[3rem] flex items-center justify-center text-slate-200 mb-8 border-2 border-dashed border-slate-200 shadow-inner">
                                <i class="fas fa-magnifying-glass-dollar text-4xl"></i>
                            </div>
                            <h3 class="text-slate-900 text-2xl font-black tracking-tight uppercase">Sem movimentações</h3>
                            <p class="text-slate-400 mt-2 font-bold uppercase tracking-widest text-[11px]">Ajuste os filtros ou realize um novo lançamento financeiro.</p>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    
    <!-- PAGINAÇÃO (ESTILO STUDIO PREMIUM) -->
    {% if is_paginated %}
    <div class="p-10 flex justify-center bg-slate-50/50 border-t border-slate-100">
        <div class="join bg-white p-1.5 rounded-2xl shadow-xl border border-slate-200">
            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}" class="join-item btn btn-ghost btn-sm rounded-xl text-primary font-black px-6 hover:bg-primary hover:text-white transition-all">« ANTERIOR</a>
            {% endif %}
            
            <button class="join-item btn btn-ghost btn-sm no-animation text-slate-900 font-black px-8 border-none cursor-default text-xs uppercase tracking-widest">
                PÁGINA {{ page_obj.number }}
            </button>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}" class="join-item btn btn-ghost btn-sm rounded-xl text-primary font-black px-6 hover:bg-primary hover:text-white transition-all">PRÓXIMA »</a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>

<style>
    /* Suavização para dados financeiros e nitidez total */
    table { font-variant-numeric: tabular-nums; }
    
    .table thead th { border-bottom: none !important; }
    
    /* Custom Scrollbar para Tabela (AZUL VIBRANTE) */
    .overflow-x-auto::-webkit-scrollbar { height: 6px; }
    .overflow-x-auto::-webkit-scrollbar-thumb { @apply bg-secondary/20 rounded-full; }
    .overflow-x-auto::-webkit-scrollbar-track { @apply bg-transparent; }
</style>